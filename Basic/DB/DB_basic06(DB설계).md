# - DB 모델링 
## : DB 설계를 위한 DB - 오라클만 관련있는게 아님! (DB자체에 대한 설계 개념)
- **데이터베이스 설계**란 모델링을 통해서 현실세계의 업무적인 **데이터 항목들과 프로세스를 추상화한 것을**<br> 
**실제적으로 구현해서 물리적으로 데이터베이스화시키는 과정**
- 머릿속에서만 설계하는 것 = 주먹구구식 설계 / **문서화 시켜서 설계화는 것 = 프로세스화 설계**
    - 실무에서는 설계는 다른 사람과 협업하는 것이기 때문에 프로세스화 설계를 지향해야한다

## @ DB 설계의 목적
1. 무결성
2. 일관된 데이터 유지 (중복X)

## @ DB Schema : 제약조건
- DDL : 테이블과 관계된 언어 
    - alter, create, drop, rename, truncate 
- DML : 행 내부와 관계된 언어 
    - select , update, insert, delete
- DCL : 데이터 베이스에 접근하고 객체들을 사용하도록 권한을 주고 회수하는 언어
    - grant, revoke

## @ 소프트웨어 개발주기 (Focus Model : 하향식모델)
### - 계획 → 분석 → 설계 → 구현 → 시험 → 유지보수

## @ DB 설계 과정 

![DB설계과정](https://user-images.githubusercontent.com/74290204/106735963-365aaf00-6658-11eb-9a5d-aa207ef18c80.png)


## 1. 요구 사항 수집 및 분석 (프로젝트 PPT에 들어갈 첫번째 요소)
- 조사 방법
    - 기초 조사 
    - 자료 조사
    - 사용자 면담
    - 설문지 조사 
    - 현장 조사 
<br>
▶ 조사한것을 바탕으로 문서화 (요구사항 - 문장화)

- 요구 사항 분석 : 데이터 베이스를 구축하고자 하는 대상 기관에 대해 조사한 결과를 분석하여 데이터베이스 설계를 위한 제약조건들로 재정리하는 것 

- 요구 사항 분석에 포함되야 할 내용
    - 시스템 목적 설명
    - 제약 조건 설정 
    - 기존 시스템에 대한 이해
    - 요구 사항 명세서
    
    ```
    [요구 사항 분석 EX]
    - K대학교 데이터베이스 요구사항

    +학생관리 
    학생의 학번, 이름, 주소, 생년월일 등 개인정보를 관리한다. 그리고 학생은 하나의 전공학과에 속해야하며, 한분의 지도교수 밑에서 전공지도를 받는다. 매 학기마다 강의를 신청하여 수업을 듣는다

    + 과목관리
    교내에 개설된 과목에 대한 정보를 관리한다(과목번호, 과목명, 과목개용 등) 그리고 각 과목은 여러 개의 섹션으로 나누어서 관리하다. 단, 섹션이 존재하지 않는 과목도 있을 수 있다.

    + 교수관리
    교수의 이름, 전공분야, 보유기술 등의 정보를 관리한다. 특히 보유기술은 여러가지가 있을 수 있다. 그리고 교수는 관련 과목을 강의하고, 지도학생을 받는다

    + 학과관리
    학과의 학과명, 사무실 위치, 전화번호 등의 정보를 관리한다. 그리고 각 학과의 교수들 중 학과장을 임명한다. 학과장은 임명날짜가 있다

    + 수강신청
    학생들은 과목을 수강하귀 위해 등록한다
    ```
<br>

## 2. ★ 개념적 설계 (프로젝트 PPT에 들어갈 첫번째 요소)
- 설계의 시작이자 끝 

![개념적설계과정](https://user-images.githubusercontent.com/74290204/106736832-4d4dd100-6659-11eb-96fe-ea45845225a8.png)

>> Entity  : 테이블이 될만한 것 , ER모델에서 가장 기본, 명사로 추출할만한 대상

### [개념적 설계 과정]

1. 명사 그룹짓기
- 요구사항분석에서 명사가 될만한것들 추출 → 다른 그룹에서 중복되는 것들 X → 살아남는 명사 → 대표 될 명사 선정

2. 관계 설정 : 동사를 포함하는 문장 속에서 관계 추출 
- 관계 설정 → 관계 타입 결정
    - 관계타입 : 엔티티 타입 간의 관계를 표현할 때 사용 
    - 관계 = 카디널리티(1: 1, 1:n , n:n)
    ```
    * 1 : n 
    emp deptno 와 dept deptno의 관계는 1 : n (부서 하나에 여러개 사용이 가능)
    → emp 가 dept의 deptno를 가져온다 emp deptno는 forien key 

    * n : n
    DB설계상에서 n : n으로 표현되는건 있어서는 절대 안됨!  
    ```

3. 애튜리뷰트 유형 정리

    - **복합** Attribute : **두개의 애트리뷰트**로 이루어짐 , **각각**의 애트리뷰트 자체로도 **독립적인 의미**를 지닌다 
    - **다치** Attribute : **하나에 여러 값**이 들어갈 수 있는 애트리뷰트, **DB는 이 유형 허용 안됨!**
    - **유도된** Attribute : **계산해서 얻은 값을 사용**하는 애트리뷰트
    
    ```
    ex]
    나이는 해가 바뀌면 계속 바꿔줘야하기 때문에 생년월일을 활용해 나이를 구해야한다
    ```
    
    - 부분키(Partial Key) : 속해진 관계에서 **부분적으로 키의 역할**을 하는 것
    >> DB에서 키 = PK, FK
    
    ```
    과목안에 섹션 - 과목이 없어지면 섹션도 없어지지만 섹션안에는 섹션만의 pk가 부분키 ? ▣ 
    ```
    
    - 전체 참여, 부분참여 
    
4. ER 다이어그램
- ER : 엑셀로 이해하는 게 가장 쉬움(어차피 2차원 테이블이여서)
<br>

## 3. 논리적 설계 (~테이블명세서 작성까지)
- 관계를 어떻게 컬럼으로 만들것인가에 대한 설계 (다이어그램을 테이블, 컬럼화 시키는 것)
    - 속성에 속성도 가능 → 컬럼으로 같이 분류해서 넣음 
    
    ```
    주소(우편번호, 기본주소, 상세주소) -> 우편번호 | 기본주소 | 상세주소
    그런데 요새는 주소 여러개 가질수있어서 1:n 관계로 따로 빼는게 추세
    ```

### ★ @ m : n 은 무조건 1 : n으로 만들어야한다(DB에서는 다치유형 허용 안되기 때문에)

- **m : n → 1 : n** 

    - 방법① 
    ```
    고객 1 - 주문 n - 상품 1
    고객 | 주문(주문수량을 속성으로 가짐) | 상품

    ▶ 주문 : 고객번호 | 상품번호 | 주문수량 
    ▶ 양쪽관계에서의 PK를 가져와서 컬럼으로 지정
    ```
    
    - 방법② 
    ```
    주문번호(PK) | 고객번호(FK) | 상품번호(FK) | 주문수량 

    ▶ 주문이라는 테이블의 PK를 따로 지정하고 양쪽관계에서의 PK를 FK로 컬럼 지정
    ```

- **1 : n 일 때 어느쪽으로 키를 가져와야하는가?** → **n쪽!**, 관계에서의 속성동 n쪽으로 키 정리
#### ★ n쪽이 유전자를 가져오는쪽(자식)
```
제조업체 1 - 공급 n - 상품

▶ 제조업체 : 제조업체명 | 전화번호 | 위치 | 담당자
▶ 상품 : 상품번호 | 상품명 | 재고량 | 단가 | 제조업체명(FK) | 공급수량
```

- **1:1일 때** 서로의 **기본키를 주고 받아 각각 외래키로** 지정 → 한쪽만 가져와도 상관없음
```
남자 - 혼인(결혼날짜) - 여자 

▶ 남자 : 남자번호 | 이름 | 나이 | 여자번호 | 결혼날짜
▶ 여자 : 여자번호 | 이름 | 나이 | 남자번호 | 결혼날짜

→  결혼날짜 불필요한 데이터 중복  
```

- **전체참여는 전체 참여 하는 쪽**으로 key를 가져와야하고 key를 주는쪽으로 결혼날짜를 보냄 
    - 둘다 전체참여 → 혼인으로(관계) entity를 만들어서 한 테이블로 생성 

- **다치애트리뷰트 → 하나의 테이블로 따로 생성**해줘야함
```
1. 사원 : 사원번호, 사원명, 직위, 부하직원(다치~)
2. 사원 : 사원번호, 사원명, 직위
3. 사원 - 부하직원릴레이션 : 사원번호, 부하직원
```
<br>

## 4. 물리적 설계

- exerd 툴을 사용해서 설계

![exerd생성](https://user-images.githubusercontent.com/74290204/107323363-79e66a80-6ae9-11eb-9c67-0673b4492a27.PNG)

![exerd생성1](https://user-images.githubusercontent.com/74290204/107323366-7b179780-6ae9-11eb-930d-51299dda4cb0.PNG)

![exerd생성11](https://user-images.githubusercontent.com/74290204/107323367-7bb02e00-6ae9-11eb-9ae3-6e2ea32163dc.PNG)

```
1. 테이블 선택 후 space바 → 속성

- 논리이름: 논리적설계 
- 물리이름 : 오라클에 들어가는 이름 (테이블명은 소문자로~)

2. 우클릭 - 새로만들기 - 컬럼
- pk일 경우에는 id로 지정 (다른 쪽 fk 들어갈때는 테이블명도 포함해서 기재)

3. 더블 클릭 하면 N.N로 변경가능(NotNull)
- 프로젝트할때는 scott .tiger로 하면안되고 계정하나 생성해서 할 것!

```

![pk설정](https://user-images.githubusercontent.com/74290204/107323277-56bbbb00-6ae9-11eb-9084-46ad55ae7ec5.PNG)


### @ 식별&비식별 

- 점선 표시선 : 비식병
- 점선 X : 식별

![점선](https://user-images.githubusercontent.com/74290204/107323304-63401380-6ae9-11eb-8bad-64578bc5ecb9.PNG)

```
- 회원아이디가 게시판에서 기본키로 들어갈때 : 식별
- 회원아이디가 게시판에서 일반 컬럼으로들어갈때(주키가X) : 비식별
```

![식별 비식별](https://user-images.githubusercontent.com/74290204/107323325-6b984e80-6ae9-11eb-8054-f77472bf66d8.PNG)

▶ 글번호로 식별하기 때문에 회원아이디는 일반 fk로 들어가면된다 

### @ 리버스&포워딩 엔지니어링 

- 리버스 엔지니어링 : DB에있는 테이블 가져오기
- 포워딩 엔지니어링 : 테이블 DB에 넣기
- jdbc 드라이버 : C:\oraclexe\app\oracle\product\11.2.0\server\jdbc\lib 에서 ojdbc6_g.jar

![exerd포워딩1](https://user-images.githubusercontent.com/74290204/107323223-3a1f8300-6ae9-11eb-8137-f951d377e158.PNG)

![exerd포워딩2](https://user-images.githubusercontent.com/74290204/107323229-3be94680-6ae9-11eb-886a-e0c5d2347c67.PNG)

![exerd포워딩3](https://user-images.githubusercontent.com/74290204/107323230-3c81dd00-6ae9-11eb-8935-6f22608d8a8d.PNG)

![exerd포워딩4](https://user-images.githubusercontent.com/74290204/107323232-3c81dd00-6ae9-11eb-94b6-3eca1c88d176.PNG)

